<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>3D Paper Text Animator</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap');
  :root {
    --bg: #111;
    --fg: #eee;
    --accent: #f5c518;
    --overlay-bg: rgba(0,0,0,0.8);
  }
  * { box-sizing: border-box; margin:0; padding:0; }
  body {
    background: var(--bg);
    color: var(--fg);
    font-family: 'Roboto Mono', monospace;
    overflow: hidden;
    display: flex; flex-direction: column; align-items: center;
    justify-content: flex-start; min-height:100vh;
  }
  h1 { margin:20px 0; font-size:2rem; }
  #controls {
    display: flex; gap:10px;
    margin-bottom:10px;
  }
  input, button { font-size:1rem; padding:8px 12px; border-radius:6px; border:none; }
  input { width:250px; }
  button { background: var(--accent); color:#111; cursor:pointer; }
  button:disabled { background:#444; cursor:default; }

  #preview {
    position: relative;
    width:90vw; max-width:800px;
    height: 50vh; min-height:300px;
    background: #000;
    perspective: 800px;
    overflow: hidden;
    border:3px solid var(--accent);
    border-radius:12px;
  }
  #backgroundLayer, #mainLayer {
    position: absolute; inset:0;
  }
  #backgroundLayer {
    display: none;
    transform-style: preserve-3d;
    animation: rotate3d 8s linear infinite;
  }
  #backgroundLayer span {
    position: absolute;
    left:50%; top:50%;
    transform: translate(-50%,-50%);
    white-space: pre-wrap;
    text-align: center;
    opacity: 0.2;
  }
  #mainLayer {
    display: none;
    display: flex; align-items: center; justify-content: center;
    padding: 0 20px;
    text-align: center;
  }

  @keyframes rotate3d {
    0%   { transform: rotateX(0deg) rotateY(0deg); }
    100% { transform: rotateX(360deg) rotateY(360deg); }
  }

  #overlay {
    position: fixed; inset:0;
    background: var(--overlay-bg);
    display: flex; align-items:center; justify-content:center;
    color: var(--accent);
    font-size: 1.8rem; text-align:center;
    visibility: hidden; opacity:0;
    transition: opacity .3s;
    padding: 0 20px;
  }
  #overlay.visible { visibility: visible; opacity:1; }
</style>
</head>
<body>

<h1>3D Paper Text Animator</h1>
<div id="controls">
  <input id="txt" maxlength="100" placeholder="Enter up to 100 chars" />
  <button id="create">Create</button>
  <button id="downloadPng" disabled>Download PNG</button>
  <button id="downloadMp4" disabled>Download MP4</button>
</div>

<div id="preview">
  <div id="backgroundLayer"></div>
  <div id="mainLayer"></div>
</div>

<div id="overlay">Bizi tercih ettiğiniz için teşekkürler!</div>

<script>
(() => {
  const blurTexts = [
    "Breaking news: markets rally globally.",
    "Scientists unveil new quantum breakthrough.",
    "Health experts emphasize balanced diet.",
    "Technology trends shape modern life.",
    "Climate action urgent, say world leaders.",
    "Sports highlights: underdog wins trophy.",
    "SpaceX readies next Mars mission launch.",
    "AI ethics spark debate in tech circles.",
    "Travel restrictions ease with vaccines.",
    "Education reforms aim for inclusivity.",
    "Renewable energy adoption accelerates.",
    "Cultural festivals return post-pandemic.",
    "Finance tips: saving for the future.",
    "Art exhibitions blend tradition & tech.",
    "Urban planning redefines smart cities.",
    "Cybersecurity threats on the rise.",
    "Medical research finds cancer marker.",
    "Social media influences modern politics.",
    "Economists predict steady recovery.",
    "Gaming industry reaches new heights."
  ];

  const txt     = document.getElementById('txt');
  const create  = document.getElementById('create');
  const dlPng   = document.getElementById('downloadPng');
  const dlMp4   = document.getElementById('downloadMp4');
  const bgLayer = document.getElementById('backgroundLayer');
  const mainL   = document.getElementById('mainLayer');
  const preview = document.getElementById('preview');
  const overlay = document.getElementById('overlay');

  let canvas, ctx, videoStream, recorder, chunks;

  function initCanvas() {
    canvas = document.createElement('canvas');
    canvas.width  = preview.clientWidth;
    canvas.height = preview.clientHeight;
    ctx = canvas.getContext('2d');
  }

  function renderSnapshot() {
    ctx.clearRect(0,0,canvas.width, canvas.height);
    // draw bgLayer
    ctx.globalAlpha = 0.2;
    ctx.fillStyle = '#fff';
    ctx.fillRect(0,0, canvas.width, canvas.height);
    ctx.globalAlpha = 1;
    // main text
    const text = txt.value.trim() || '';
    ctx.font = `${Math.floor(canvas.height/6)}px Roboto Mono`;
    ctx.fillStyle = '#f5c518';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(text, canvas.width/2, canvas.height/2);
  }

  function showOverlay(msg, timeout=2000) {
    overlay.textContent = msg;
    overlay.classList.add('visible');
    setTimeout(() => overlay.classList.remove('visible'), timeout);
  }

  create.onclick = async () => {
    const text = txt.value.trim();
    if(!text) return alert('Lütfen metin gir!');
    // hazırlık
    bgLayer.innerHTML = '';
    mainL.textContent = '';
    // background texts same size as main
    bgLayer.style.display = 'block';
    mainL.style.display = 'none';
    // create spans
    const fontSize = preview.clientHeight/6;
    for(let i=0;i<blurTexts.length;i++){
      const span = document.createElement('span');
      span.textContent = blurTexts[i];
      span.style.fontSize = fontSize+'px';
      span.style.transform = `
        translate3d(${Math.random()*200-100}px,
                    ${Math.random()*200-100}px,
                    ${Math.random()*400-200}px)
      `;
      bgLayer.appendChild(span);
    }
    // delay animation show
    const delay = 2000;
    let cnt = Math.ceil(delay/1000);
    showOverlay(`Oluşturuluyor... ${cnt}`);
    const iv = setInterval(()=>{
      cnt--;
      showOverlay(`Oluşturuluyor... ${cnt}`);
      if(cnt<=0) clearInterval(iv);
    },1000);
    await new Promise(r=>setTimeout(r,delay));
    overlay.classList.remove('visible');
    // göster main
    mainL.style.display = 'flex';
    mainL.textContent = text;
    mainL.style.fontSize = fontSize+'px';
    // aktif et indir
    dlPng.disabled = false;
    dlMp4.disabled = false;
  };

  dlPng.onclick = ()=>{
    if(!canvas) initCanvas();
    renderSnapshot();
    const a = document.createElement('a');
    a.href = canvas.toDataURL('image/png');
    a.download = 'text.png';
    a.click();
    showOverlay('Bizi tercih ettiğiniz için teşekkürler!',1500);
  };

  dlMp4.onclick = ()=>{
    if(!canvas) initCanvas();
    renderSnapshot();
    const stream = canvas.captureStream(30);
    recorder = new MediaRecorder(stream, {mimeType:'video/webm'});
    chunks = [];
    recorder.ondataavailable = e=>chunks.push(e.data);
    recorder.onstop = ()=>{
      const blob = new Blob(chunks,{type:'video/webm'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href=url; a.download='text.mp4';
      a.click();
      showOverlay('Bizi tercih ettiğiniz için teşekkürler!',1500);
    };
    recorder.start();
    setTimeout(()=> recorder.stop(),2000);
  };

  // resize canvas on window
  window.addEventListener('resize', ()=> initCanvas());
  // initial
  initCanvas();
})();
</script>
</body>
</html>
